<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="IT 강좌 동영상 학습 사이트">
        <meta name="keywords" content="IT, 강좌, 교육, 동영상, 학습">
        <title>ME - IT 교육 플랫폼</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
        <style>
            /* Custom responsive styles */
            @media (max-width: 767.98px) {
                .navbar-nav {
                    flex-direction: column;
                    width: 100%;
                }
                .navbar-nav .nav-item {
                    margin-bottom: 15px;
                    width: 100%;
                }
                .nav-item .form-control {
                    width: 100%;
                }
                #crsView {
                    max-height: 300px;
                    overflow-y: auto;
                }
            }
            
            /* General responsive improvements */
            .navbar-collapse {
                padding-top: 10px;
            }
            
            .dropdown-menu {
                max-height: 400px;
                overflow-y: auto;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            }
            
            video {
                max-width: 100%;
                height: auto;
            }
            
            /* Better select elements */
            .form-control {
                margin-right: 5px;
                border-radius: 8px;
                height: 45px;
                transition: all 0.3s;
                border: 1px solid #ddd;
                box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            }
            
            .form-control:focus {
                border-color: #28a745;
                box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25);
            }
            
            /* Option colors for select elements */
            #mc option[value="class_it"] {
                background-color: #e6f7ff;
                color: #0366d6;
            }
            
            #mc option[value="class_li"] {
                background-color: #f0fff4;
                color: #28a745;
            }
            
            /* Styling for dynamically created options */
            #sm option:not([value="0"]), 
            #cls option:not([value="0"]) {
                padding: 8px;
            }
            
            #sm option:nth-child(odd):not([value="0"]) {
                background-color: #fff0f6;
                color: #e83e8c;
            }
            
            #sm option:nth-child(even):not([value="0"]) {
                background-color: #f0f4ff;
                color: #4263eb;
            }
            
            #cls option:nth-child(odd):not([value="0"]) {
                background-color: #f3f0ff;
                color: #7950f2;
            }
            
            #cls option:nth-child(even):not([value="0"]) {
                background-color: #fff9db;
                color: #f59f00;
            }
            
            /* Selected option styling */
            select:focus option:checked {
                background: linear-gradient(0deg, #28a745 0%, #28a745 100%);
                background-color: #28a745 !important;
                color: white !important;
            }
            
            /* Container for course content */
            #view {
                margin-top: 20px;
                overflow-x: auto;
                background-color: #f8f9fa;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            }
            
            /* Better dropdown button styling */
            .dropdown {
                margin-top: 5px;
                margin-bottom: 5px;
            }
            
            .dropdown-toggle {
                border-radius: 8px;
                height: 45px;
                width: 100%;
                text-align: left;
                position: relative;
                font-weight: 500;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            }
            
            .dropdown-toggle::after {
                position: absolute;
                right: 15px;
                top: 50%;
                transform: translateY(-50%);
            }
            
            .dropdown-item {
                padding: 10px 15px;
                border-bottom: 1px solid #f1f1f1;
                transition: all 0.2s;
            }
            
            .dropdown-item:hover {
                background-color: #f8f9fa;
                color: #28a745;
            }
            
            .dropdown-item:last-child {
                border-bottom: none;
            }
            
            /* Category navigation styling */
            .nav-item {
                margin: 0 5px;
            }
            
            .nav-item label {
                color: #495057;
                font-weight: 500;
                margin-bottom: 5px;
                display: block;
                font-size: 14px;
            }
            
            /* Category pills */
            .category-pills {
                margin-bottom: 15px;
                display: flex;
                flex-wrap: wrap;
            }
            
            .category-pill {
                background-color: #e9ecef;
                padding: 8px 15px;
                border-radius: 20px;
                margin-right: 10px;
                margin-bottom: 10px;
                font-size: 14px;
                cursor: pointer;
                transition: all 0.2s;
            }
            
            .category-pill:hover, .category-pill.active {
                background-color: #28a745;
                color: white;
            }
            
            /* Alert styling */
            .alert {
                border-radius: 8px;
                box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            }
            
            @media (min-width: 768px) {
                .navbar-nav {
                    align-items: center;
                }
                
                .dropdown-toggle {
                    width: auto;
                    min-width: 150px;
                }
                
                .nav-item {
                    display: flex;
                    flex-direction: column;
                }
            }
            
            /* Dropdown course item colors */
            #crsView .dropdown-item:nth-child(odd) {
                border-left: 4px solid #4263eb;
            }
            
            #crsView .dropdown-item:nth-child(even) {
                border-left: 4px solid #e83e8c;
            }
            
            #crsView .dropdown-item:hover {
                background-color: #f8f9fa;
                color: #28a745;
                border-left-width: 6px;
            }
            
            /* Course Material Download Button */
            .course-download-btn {
                display: block;
                margin-top: 15px;
                background-color: #28a745;
                color: white;
                padding: 10px 15px;
                border-radius: 8px;
                text-align: center;
                font-weight: 500;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                transition: all 0.2s;
                text-decoration: none !important;
            }
            
            .course-download-btn:hover {
                background-color: #218838;
                color: white;
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            }
            
            .course-download-btn i {
                margin-right: 8px;
            }
            
            #downloadContainer {
                margin-top: 15px;
                display: none;
            }
            
            /* Footer styling */
            footer {
                margin-top: 50px;
                padding: 20px 0;
                background-color: #f8f9fa;
                border-top: 1px solid #e9ecef;
            }
            
            footer p {
                margin-bottom: 0;
                color: #6c757d;
            }
            
            /* Loading indicator */
            .loading-indicator {
                display: none;
                text-align: center;
                margin: 20px 0;
            }
            
            .loading-indicator i {
                color: #28a745;
                font-size: 2rem;
                animation: spin 1s infinite linear;
            }
            
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            
            /* Error message styling */
            .error-message {
                display: none;
                padding: 15px;
                border-radius: 8px;
                background-color: #fff5f5;
                border: 1px solid #ffebee;
                color: #d32f2f;
                margin: 15px 0;
            }
            
            /* Progress bar for video loading */
            .video-progress {
                height: 4px;
                background-color: #e9ecef;
                border-radius: 2px;
                margin-top: 10px;
                overflow: hidden;
            }
            
            .video-progress-bar {
                height: 100%;
                background-color: #28a745;
                width: 0%;
                transition: width 0.3s;
            }
        </style>
    </head>
    <body>
        <!-- jQuery, Popper.js, and Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script>
        
        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
          <div class="container-fluid">
              <a class="navbar-brand" href="#">
                  <i class="fas fa-graduation-cap text-success mr-2"></i>ME
              </a>
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                  <li class="nav-item">
                    <label for="mc"><i class="fas fa-th-large"></i> 카테고리</label>
                    <select id="mc" class="form-control" aria-label="카테고리 선택">
                        <option value="0">선택하세요</option>
                        <option value="class_it">IT 실무과정</option>
                        <option value="class_li">자격증 과정</option>
                    </select>    
                  </li>
                  <li class="nav-item">
                    <label for="sm"><i class="fas fa-tags"></i> 분류</label>
                    <select id="sm" class="form-control" aria-label="분류 선택">
                        <!-- Dynamically filled -->
                    </select>
                  </li>
                  <li class="nav-item">
                    <label for="cls"><i class="fas fa-book"></i> 강좌</label>
                    <select id="cls" class="form-control" aria-label="강좌 선택">
                        <!-- Dynamically filled -->
                    </select>
                  </li>
                  <li class="nav-item">
                    <label><i class="fas fa-play-circle"></i> 강의목록</label>
                    <div class="dropdown">
                      <a class="btn btn-success dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        강좌 선택
                      </a>
                      <div id="crsView" class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                        <!-- Dynamically filled -->
                      </div>
                    </div>
                  </li>
                </ul>
              </div>
          </div>
        </nav>
        
        <!-- Main Content -->
        <main>
            <!-- Loading Indicator -->
            <div class="container-fluid px-3 px-md-5 loading-indicator" id="loadingIndicator">
                <i class="fas fa-spinner"></i>
                <p>로딩 중...</p>
            </div>
            
            <!-- Error Message -->
            <div class="container-fluid px-3 px-md-5 error-message" id="errorMessage">
                <i class="fas fa-exclamation-circle mr-2"></i>
                <span id="errorText">오류가 발생했습니다. 다시 시도해 주세요.</span>
            </div>
            
            <!-- Course Content View -->
            <div class="container-fluid px-3 px-md-5" id="view">
                <!-- This is where the content will be displayed -->
                <div class="alert alert-info text-center mt-3">
                    <h4><i class="fas fa-info-circle"></i> 강좌를 선택해 주세요</h4>
                    <p>위의 메뉴에서 카테고리, 분류, 강좌를 순서대로 선택하시면 컨텐츠가 표시됩니다.</p>
                </div>
            </div>
            
            <!-- Download container -->
            <div class="container-fluid px-3 px-md-5" id="downloadContainer">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-file-archive"></i> 교안 다운로드</h5>
                        <p class="card-text">선택한 강좌의 교안을 다운로드합니다.</p>
                        <a href="#" id="courseDownloadBtn" class="course-download-btn" download>
                            <i class="fas fa-download"></i> 교안 다운로드
                        </a>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="text-center">
            <div class="container">
                <p>&copy; ME. 모든 권리 보유.</p>
            </div>
        </footer>
        
        <!-- Hidden container for JavaScript processing -->
        <div class="d-none" id="src"></div>
        
        <!-- Main JavaScript -->
        <script src="js.js" defer="defer" type="text/javascript"></script>
        
        <!-- Course Material Download and UI Enhancement Script -->
        <script>
            $(document).ready(function() {
                // Show loading indicator when making AJAX requests
                $(document).ajaxStart(function() {
                    $('#loadingIndicator').show();
                }).ajaxStop(function() {
                    $('#loadingIndicator').hide();
                });
                
                // Handle AJAX errors
                $(document).ajaxError(function(event, jqXHR, settings, thrownError) {
                    $('#errorText').text('데이터를 불러오는 중 오류가 발생했습니다: ' + thrownError);
                    $('#errorMessage').show().delay(5000).fadeOut();
                });
                
                // When a course is selected, show the download container
                $('#cls').on('change', function() {
                    if ($(this).val() != '0') {
                        $('#downloadContainer').show();
                        
                        // Update the download link when course is selected
                        let courseValue = $(this).val();
                        let courseCode = courseValue.split('-')[0];
                        
                        // Set the download URL with the correct format
                        $('#courseDownloadBtn').attr('href', 'https://www.itgo.kr/data/lecture/' + courseCode + '/' + courseCode + '.zip');
                        
                        // Update download button text with course name
                        let courseName = $('#cls option:selected').text();
                        $('#courseDownloadBtn').html('<i class="fas fa-download"></i> ' + courseName + ' 교안 다운로드');
                    } else {
                        $('#downloadContainer').hide();
                    }
                });
                
                // Also handle the case when dropdown items are clicked
                $(document).on('click', '#crsView .dropdown-item', function() {
                    $('#downloadContainer').show();
                    
                    // Extract course code from the clicked link
                    let href = $(this).attr('href');
                    if (href) {
                        let courseCode = '';
                        
                        // Extract course code from URL pattern
                        if (href.includes('/sample/')) {
                            courseCode = href.split('/sample/')[1].split('/')[0];
                        }
                        
                        if (courseCode) {
                            // Update download button URL with the correct format
                            $('#courseDownloadBtn').attr('href', 'https://www.itgo.kr/data/lecture/' + courseCode + '/' + courseCode + '.zip');
                            
                            // Update download button text with lesson name
                            let lessonName = $(this).text();
                            $('#courseDownloadBtn').html('<i class="fas fa-download"></i> ' + lessonName + ' 교안 다운로드');
                        }
                    }
                    
                    return true;
                });
                
                // Handle download errors
                $('#courseDownloadBtn').on('error', function() {
                    $('#errorText').text('교안 다운로드 중 오류가 발생했습니다. 잠시 후 다시 시도해 주세요.');
                    $('#errorMessage').show().delay(5000).fadeOut();
                });
            });
        </script>
    </body>
</html>